#### 심심해서 해본 Terraform workspace가 내 업무에 적합한지 테스트 

[글들을 보면](https://velog.io/@gentledev10/terraform-workspace) tf 실행 시 전역변수(var)를 외부파일로 불러와서 각 워크스페이스 실행할 때에 injection 하는 것을 알 수 있는데, 나는 이것도 불편하게 느껴졌다.. 

또한 워크스페이스 별로 생성하지 말아야 할 것과 생성해야할 것 등 좀 더 실무적인 것들을 검증해보고 싶어졌다. 


##### 검증항목: 
1. 워크스페이스 별 변수 분기처리
    - local을 이용하여 처리 가능 

2. 워크스페이스 별 생성해야할 리소스와 그렇지 않은 리소스 정의
    - count를 이용하여 워크스페이스 별 리소스 수량 변경 가능 

3. 워크스페이스 별 생성된 리소스/그렇지 않은 리소스의 output 관리 (remote state로 다른 곳에서 참조가 용의한지)
    - output value에 if문을 넣어서 리소스가 생성되지 않는 워크스페이스에서는 null로 output 되게끔 설정



##### 장점
|순번|장점|세부 내용|비고|
|---|--------------|--------------------------------------------------------------------|---|
|01|강력한 코드 일관성|각 환경마다 디렉토리로 관리하게 되었을 때 코드 일관성이 무너질 수 있는데 그럴 경우가 전혀 없음| |
|01|강력한 코드 일관성|Git branch 관리에서도 벗어날 수 있고 다양한 코드를 관리할 필요가 없음| |
|02|state 관리 편의성|env 디렉터리 밑에 워크스페이스 이름 별로 세부 폴더가 생성되고 state가 관리됨| |


##### 단점
|순번|장점|세부 내용|비고|
|---|--------------|--------------------------------------------------------------------|---|
|01|코드의 복잡성 증가|각 워크스페이스 별로 100% 동일한 환경을 찍어내진 않을 것임.. 이에 따른 분기처리(if) 처리가 코드가 비대해질 수록 많아지고 복잡해짐| |
|02|모듈 복잡성|퍼블릭하게 제공되는 모듈의 경우 워크스페이스를 고려하지 않은채로 생성되어 있어서 워크스페이스와 같이 사용할 시 모듈을 손 봐야 함-환경 별로 생성/변경 되는 조건으로| |



